

## 树上DP

- [337. 打家劫舍 III](https://leetcode.cn/problems/house-robber-iii/description/)

```py
class Solution:
    def rob(self, root: Optional[TreeNode]) -> int:

        def dfs(node):
            if node is None: return 0,0
            lrob,lnot = dfs(node.left)
            rrob,rnot = dfs(node.right)
            return node.val + lnot + rnot, max(lrob,lnot) + max(rrob,rnot)

        return max(dfs(root))
```

```py
class Solution:
    def rob(self, root: Optional[TreeNode]) -> int:
        @cache
        def dfs(node, r):
            if node is None: return 0
            if r:
                return node.val + dfs(node.left, False) + dfs(node.right, False)
            else:
                return max(dfs(node.left,False), dfs(node.left,True)) + max(dfs(node.right,False),dfs(node.right,True))

        return max(dfs(root,True),dfs(root,False))
```